{% extends "base.html" %}
{% block content %}
{% if mode == 'new' %}
  <h1 class="h4 mb-3">New Task</h1>
{% else %}
  <h1 class="h4 mb-3">Edit Task</h1>
{% endif %}

{% if error %}
  <div class="alert alert-danger" role="alert">{{ error }}</div>
{% endif %}

<form method="post" class="card card-body">
  <div class="row g-3">
    <div class="col-12">
      <label class="form-label">Task Name</label>
      <input class="form-control" type="text" name="name" value="{{ name }}" required>
    </div>

    <div class="col-12 col-md-6">
      <label class="form-label">Task Type</label>
      <input class="form-control" type="text" name="task_type" value="{{ task_type }}" required>
    </div>

    <div class="col-12 col-md-6">
      <label class="form-label">Due Date (optional)</label>
      <input class="form-control" type="datetime-local" name="due_date" value="{{ due_date }}">
      <div class="form-text">If left blank, the creation time is used as the due date.</div>
    </div>

    <div class="col-12">
      <label class="form-label">Description</label>
      <textarea class="form-control" name="description" rows="3">{{ description }}</textarea>
    </div>

    <div class="col-12">
      <label class="form-label">URL</label>
      <input class="form-control" type="url" name="url" value="{{ url }}" placeholder="https://...">
    </div>

    <div class="col-12 col-md-4">
      <label class="form-label">Recurrence Type</label>
      <select class="form-select" name="recurrence_type">
        <option value="none" {% if recurrence_type=='none' %}selected{% endif %}>None</option>
        <option value="post_completion" {% if recurrence_type=='post_completion' %}selected{% endif %}>Post-completion</option>
        <option value="multi_slot_daily" {% if recurrence_type=='multi_slot_daily' %}selected{% endif %}>Multi-slot daily</option>
        <option value="fixed_clock" {% if recurrence_type=='fixed_clock' %}selected{% endif %}>Fixed clock</option>
      </select>
    </div>

    <div class="col-12 col-md-4">
      <label class="form-label">Recurrence Interval / Rule</label>
      <input class="form-control" type="text" name="recurrence_interval" value="{{ recurrence_interval }}" placeholder="e.g. 8h, Every Tuesday">
      <div class="form-text">For fixed clock, you can use a duration or a calendar rule.</div>
    </div>

    <div class="col-12 col-md-4">
      <label class="form-label">Recurrence Times</label>
      <input class="form-control" type="text" name="recurrence_times" value="{{ recurrence_times }}" placeholder="e.g. 08:00, 15:00">
      <div class="form-text">Used for multi-slot daily.</div>
    </div>

    <div class="col-12">
      <label class="form-label">Tags (comma-separated)</label>
      <input class="form-control" type="text" name="tags" value="{{ tags }}" placeholder="e.g. finance, urgent">
    </div>

    <div class="col-12 d-flex gap-2">
      <button class="btn btn-primary" type="submit">Save</button>
      <a class="btn btn-outline-secondary" href="/dashboard">Cancel</a>
    </div>
  </div>
</form>
{% endblock %}
