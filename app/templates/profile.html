{% extends "base.html" %}
{% block content %}
<h1 class="h4 mb-3">Profile</h1>

{% if error %}
  <div class="alert alert-danger" role="alert">{{ error }}</div>
{% endif %}
{% if success %}
  <div class="alert alert-success" role="alert">{{ success }}</div>
{% endif %}

<form method="post" class="card card-body">
  <div class="row g-3">
    <div class="col-12">
      <label class="form-label">Username</label>
      <input class="form-control" type="text" name="username" value="{{ current_user.username }}" required>
    </div>

    <div class="col-12 col-md-6">
      <label class="form-label">Theme</label>
      <select class="form-select" name="theme">
        <option value="system" {% if current_user.theme=='system' %}selected{% endif %}>System</option>
        <option value="light" {% if current_user.theme=='light' %}selected{% endif %}>Light</option>
        <option value="dark" {% if current_user.theme=='dark' %}selected{% endif %}>Dark</option>
      </select>
    </div>

    <div class="col-12 col-md-6">
      <label class="form-label">Purge archived tasks after (days)</label>
      <input class="form-control" type="number" min="1" max="3650" name="purge_days" value="{{ current_user.purge_days }}" required>
      <div class="form-text">Archived = completed or deleted tasks.</div>
    </div>

    <div class="col-12">
      <label class="form-label">Email address (required for non-admin)</label>
      <input class="form-control" type="email" name="email" value="{{ current_user.email or '' }}" placeholder="name@example.com">
      <div class="form-text">If provided, the system can send overdue reminders and password reset links.</div>
    </div>

    <div class="col-12"><hr></div>

    <div class="col-12 col-md-6">
      <label class="form-label">Current password</label>
      <input class="form-control" type="password" name="current_password" autocomplete="current-password">
    </div>
    <div class="col-12 col-md-6">
      <label class="form-label">New password</label>
      <input class="form-control" type="password" name="new_password" autocomplete="new-password">
      <div class="form-text">Leave both fields blank to keep the current password.</div>
    </div>

    <div class="col-12">
      <button class="btn btn-primary" type="submit">Save</button>
    </div>
  </div>
</form>
{% endblock %}
